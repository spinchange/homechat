<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>HomeChat</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0084ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="HomeChat">
  <link rel="apple-touch-icon" href="/icon.svg">

  <link rel="stylesheet" href="/style.css">
</head>
<body>

<!-- Name Modal -->
<div id="modal-overlay">
  <div id="modal">
    <h2>Welcome to HomeChat</h2>
    <p>Enter your name so everyone knows it's you.</p>
    <p id="name-error"></p>
    <input id="name-input" type="text" placeholder="Your name" maxlength="32" autocomplete="off" autocorrect="off" spellcheck="false">
    <button id="name-submit">Let's chat</button>
  </div>
</div>

<!-- App -->
<div id="app">

  <!-- Sidebar overlay (mobile) -->
  <div id="sidebar-overlay"></div>

  <!-- Sidebar -->
  <nav id="sidebar">
    <div id="sidebar-header">
      <svg width="22" height="22" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="100" height="100" rx="20" fill="#0084ff"/>
        <path d="M20 28 Q20 18 30 18 L70 18 Q80 18 80 28 L80 58 Q80 68 70 68 L54 68 L42 82 L42 68 L30 68 Q20 68 20 58 Z" fill="white"/>
        <circle cx="38" cy="43" r="5" fill="#0084ff"/>
        <circle cx="50" cy="43" r="5" fill="#0084ff"/>
        <circle cx="62" cy="43" r="5" fill="#0084ff"/>
      </svg>
      HomeChat
    </div>

    <div style="flex:1; overflow-y:auto;">
      <div class="sidebar-section">
        <div class="sidebar-label">
          Rooms
          <button id="add-room-btn" title="Add a room">+</button>
        </div>
        <div id="new-room-form" class="hidden">
          <input id="new-room-input" type="text" placeholder="room-name" maxlength="32" autocomplete="off" autocorrect="off" spellcheck="false">
          <label id="private-toggle-label">
            <input type="checkbox" id="new-room-private"> Private room
          </label>
          <div id="new-room-members" class="hidden"></div>
          <div class="new-room-actions">
            <button id="new-room-cancel">Cancel</button>
            <button id="new-room-submit">Add</button>
          </div>
        </div>
        <div id="room-list"></div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-label">People</div>
        <div id="people-list"></div>
      </div>
    </div>

    <div style="padding:10px 12px; border-top:1px solid var(--border);">
      <div style="font-size:12px; color:var(--text-muted); text-align:center;" id="my-name-display"></div>
    </div>
  </nav>

  <!-- Chat -->
  <main id="chat">
    <div id="chat-header">
      <button id="menu-btn" aria-label="Toggle sidebar">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <rect x="2" y="4" width="16" height="2" rx="1"/>
          <rect x="2" y="9" width="16" height="2" rx="1"/>
          <rect x="2" y="14" width="16" height="2" rx="1"/>
        </svg>
      </button>
      <div style="flex:1">
        <div id="chat-title">Select a room</div>
        <div id="chat-subtitle"></div>
      </div>
    </div>

    <div id="conn-status">Connecting…</div>

    <div id="messages"></div>

    <div id="input-bar">
      <input id="img-input" type="file" accept="image/*" style="display:none" aria-hidden="true">
      <input id="cam-input" type="file" accept="image/*" capture="environment" style="display:none" aria-hidden="true">
      <button id="img-btn" aria-label="Send image" title="Send from photos">

        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/>
          <polyline points="21 15 16 10 5 21"/>
        </svg>
      </button>
      <button id="cam-btn" aria-label="Take photo" title="Take a photo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
          <circle cx="12" cy="13" r="4"/>
        </svg>
      </button>
      <input id="msg-input" type="text" placeholder="Message…" maxlength="2000" autocomplete="off">
      <button id="send-btn" aria-label="Send">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
        </svg>
      </button>
    </div>
  </main>

</div>

<!-- Lightbox -->
<div id="lightbox" class="hidden" aria-modal="true" role="dialog">
  <img id="lightbox-img" src="" alt="Full size image">
</div>

<script src="/app.js"></script>
</body>
</html>
